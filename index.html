<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A package to efficiently work with GEDI data • chewie</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A package to efficiently work with GEDI data">
<meta name="description" content="What the package does (one paragraph).">
<meta property="og:description" content="What the package does (one paragraph).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">chewie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/gedi-L1B-waveforms.html">GEDI Level 1B Waveforms</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Permian-Global-Research/chewie/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="chewie">chewie<a class="anchor" aria-label="anchor" href="#chewie"></a>
</h1></div>
<p><img src="reference/figures/chewie-hex.png" align="right" height="300" style="float:right; height:300px;"></p>
<!-- badges: start -->

<p>The goal of chewie is to make downloading GEDI data as simple as possible. This includes the point-level products: 1B, 2A, 2B and 4A. Here is a quick summary of design choices that enables {chewie} to achieve this:</p>
<ul>
<li><p>Data are downloaded and converted to parquet files which can then be read using <a href="https://arrow.apache.org/docs/r/index.html" class="external-link">{arrow}</a> and converted to <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> objects. This approach is performative as it only requires each entire granule to be loaded into memory once (when it is converted from hdf5 to parquet). From here on we can use <a href="https://dplyr.tidyverse.org/" class="external-link">dplyr</a> verbs (or base R) to <code>filter</code>, <code>mutate</code> and <code>select</code> data as required without needing to load all shots, from a given granule, into memory.</p></li>
<li><p>A system-level cache is used to store the data. This means that once a file has been downloaded it will not be downloaded again even if working in a different project (it is also possible to specify a unique cache location for each project).</p></li>
<li><p>There is support for spatial filtering of granules that intersect an area of interest and not only by a bounding box; this frequently reduces the amount of irrelevant data that is downloaded.</p></li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of chewie like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"Permian-Global-Research/chewie"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>First, let’s load in some libraries. {dplyr} isn’t essential but it is recommended as it’s an excellent and highly performative option for working with arrow datasets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Permian-Global-Research/chewie" class="external-link">chewie</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Here are some useful helper functions to set up your credentials (using <code><a href="reference/chewie-credentials.html">chewie_creds()</a></code>) and check that those credentials and the cache are set up correctly (using <code><a href="reference/chewie_health_check.html">chewie_health_check()</a></code>). By default the cache is set up in the <code>.chewie</code> folder in your home directory. You can change this by running <code>chewie_cache_set()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/chewie-credentials.html">chewie_creds</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># to set up your credentials</span></span>
<span><span class="fu"><a href="reference/chewie_health_check.html">chewie_health_check</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># to check your credentials and cache setup.</span></span></code></pre></div>
<p>Now, let’s search for GEDI 2A data that intersects with the Prairie Creek Redwoods State Park, California (the dataset is included with the package). We then plot the footprints of the granules that intersect with this area to check out what we’ve got. Note that by default, both <code>find_gedi</code> and <code>grab_gedi</code> cache their outputs so, when these functions are re-run, the data will be loaded from the cache rather than downloaded again, even in a different R session.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prairie_creek</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"geojson"</span>, <span class="st">"prairie-creek.geojson"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"chewie"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gedi_2a_search</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chewie-find-gedi.html">find_gedi</a></span><span class="op">(</span><span class="va">prairie_creek</span>,</span>
<span>  gedi_product <span class="op">=</span> <span class="st">"2A"</span>,</span>
<span>  date_start <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span>
<span>  date_end <span class="op">=</span> <span class="st">"2023-01-31"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Using cached GEDI find result</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gedi_2a_search</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── chewie.find ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; • GEDI-2A</span></span>
<span><span class="co">#&gt;                     id          time_start            time_end                                                   url cached</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;              &lt;POSc&gt;              &lt;POSc&gt;                                                &lt;char&gt; &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1: G2754665065-LPCLOUD 2023-01-25 05:14:31 2023-01-25 06:47:21 https://data.lpdaac.earthdatacloud.nasa.gov/lp-pro...   TRUE</span></span>
<span><span class="co">#&gt; 1 variable(s) not shown: [geometry &lt;sfc_POLYGON&gt;]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>Whilst there is a <code>plot</code> method for <em>chewie.find</em> objects, a great alternative is to plot a leaflet map with <code>chewie_show</code>, which can be static or interactive (this uses the fantastic {<a href="https://r-spatial.github.io/mapview/" class="external-link">mapview</a>} under the hood).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/chewie_show.html">chewie_show</a></span><span class="op">(</span></span>
<span>  <span class="va">gedi_2a_search</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-show-find-data-1.png" width="100%"></p>
<p>Now we use <code>grab_gedi</code> to download the data - this function internally, converts the data to parquet format and stores it in the cache. The returned value is an <em>arrow_dplyr_query</em> object. We can then use {dplyr} verbs to <code>filter</code>/<code>select</code> the data as we wish before finally using <code>collect_gedi</code> to convert the data to a sf object. If no filtering/selection is carried out then <code>collect_gedi</code> will return all the available columns/rows for the AOI.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gedi_2a_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/grab_gedi.html">grab_gedi</a></span><span class="op">(</span><span class="va">gedi_2a_search</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">quality_flag</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>    <span class="va">degrade_flag</span> <span class="op">==</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">beam</span>, <span class="va">date_time</span>, <span class="va">lat_lowestmode</span>, <span class="va">lon_lowestmode</span>, <span class="va">elev_highestreturn</span>,</span>
<span>    <span class="va">elev_lowestmode</span>, <span class="va">rh0</span>, <span class="va">rh25</span>, <span class="va">rh50</span>, <span class="va">rh75</span>, <span class="va">rh95</span>, <span class="va">rh100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/collect_gedi.html">collect_gedi</a></span><span class="op">(</span>gedi_find <span class="op">=</span> <span class="va">gedi_2a_search</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data found in cache</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gedi_2a_sf</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 884 features and 10 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -124.069 ymin: 41.3609 xmax: -123.9959 ymax: 41.43904</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 884 × 11</span></span>
<span><span class="co">#&gt;     beam date_time           elev_highestreturn elev_lowestmode   rh0    rh25</span></span>
<span><span class="co">#&gt;  * &lt;int&gt; &lt;dttm&gt;                           &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     0 2023-01-25 06:09:05             -19.6           -23.8  -3.55 -1.12  </span></span>
<span><span class="co">#&gt;  2     0 2023-01-25 06:09:05             -20.7           -24.2  -3.89 -1.27  </span></span>
<span><span class="co">#&gt;  3     0 2023-01-25 06:09:05             -20.7           -24.2  -3.93 -1.27  </span></span>
<span><span class="co">#&gt;  4     0 2023-01-25 06:09:05              -2.29          -23.3  -3.37 -0.0300</span></span>
<span><span class="co">#&gt;  5     0 2023-01-25 06:09:05              27.7           -15.0  -2.54  9.70  </span></span>
<span><span class="co">#&gt;  6     0 2023-01-25 06:09:05              35.8             4.55 -3.74 12.1   </span></span>
<span><span class="co">#&gt;  7     0 2023-01-25 06:09:05              55.9            12.2  -1.57 16.8   </span></span>
<span><span class="co">#&gt;  8     0 2023-01-25 06:09:05              94.6            41.0  -1.53 25.8   </span></span>
<span><span class="co">#&gt;  9     0 2023-01-25 06:09:05              95.3            42.5  -3.78  6.06  </span></span>
<span><span class="co">#&gt; 10     0 2023-01-25 06:09:05              98.3            33.8  -2.32 29.9   </span></span>
<span><span class="co">#&gt; # ℹ 874 more rows</span></span>
<span><span class="co">#&gt; # ℹ 5 more variables: rh50 &lt;dbl&gt;, rh75 &lt;dbl&gt;, rh95 &lt;dbl&gt;, rh100 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
<p>Finally, we can plot the data. Again we can use the generic <code>chewie_show</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/chewie_show.html">chewie_show</a></span><span class="op">(</span></span>
<span>  <span class="va">gedi_2a_sf</span>,</span>
<span>  zcol <span class="op">=</span> <span class="st">"rh95"</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">13</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  aoi_color <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-show-2a-data-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="other-relevant-packagessoftware">Other relevant packages/software<a class="anchor" aria-label="anchor" href="#other-relevant-packagessoftware"></a>
</h2>
<ul>
<li><p><a href="https://github.com/carlos-alberto-silva/rGEDI" class="external-link">{rGEDI}</a> provides the ability download GEDI data but also a great deal of additional functionality for visualisation, post-processing and modelling.</p></li>
<li><p><a href="https://github.com/VangiElia/GEDI4R" class="external-link">{GEDI4R}</a> which similarly provides a suit of tools for downloading, visualising and modelling GEDI data, but with a focus on the 4A product.</p></li>
<li><p><a href="https://github.com/EduinHSERNA/pyGEDI" class="external-link">pyGEDI</a> is a Python package for downloading and visualising GEDI data.</p></li>
<li><p><a href="https://github.com/nasa/GEDI-Data-Resources" class="external-link">GEDI-Data-Resources</a> is a collection of scripts for both python and R that provide examples of how to download and process GEDI data.</p></li>
</ul>
<p>These resources have been a great source of inspiration for {chewie}; we would like to thank the authors for their great work!</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Permian-Global-Research/chewie/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Permian-Global-Research/chewie/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing chewie</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Hugh Graham <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9451-5010" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/Permian-Global-Research/chewie/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Permian-Global-Research/chewie/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/Permian-Global-Research/chewie?branch=main" class="external-link"><img src="https://codecov.io/gh/Permian-Global-Research/chewie/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hugh Graham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
