<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>GEDI Level 1B Waveforms • chewie</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GEDI Level 1B Waveforms">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chewie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gedi-L1B-waveforms.html">GEDI Level 1B Waveforms</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Permian-Global-Research/chewie/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>GEDI Level 1B Waveforms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Permian-Global-Research/chewie/blob/main/vignettes/gedi-L1B-waveforms.Rmd" class="external-link"><code>vignettes/gedi-L1B-waveforms.Rmd</code></a></small>
      <div class="d-none name"><code>gedi-L1B-waveforms.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to use the <code>chewie</code> package
to download and extract GEDI Level 1B waveforms.</p>
<p>First let’s load the <code>chewie</code> package and the
<code>ggplot2</code> package for plotting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Permian-Global-Research/chewie" class="external-link">chewie</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>First, we define an area of interest. In this case, we will use
prairie creek national park as our area of interest. The
<code>chewie</code> package provides a number of example spatial vector
data sets that can be used for this purpose. Here we use the
<code>prairie-creek.geojson</code> data set, which is a simple polygon
defining the park boundary. You can alternatively use the
<code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read()</a></code> function to read in your own spatial vector
data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcreek</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"geojson"</span>, <span class="st">"prairie-creek.geojson"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"chewie"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now we can search for GEDI Level 1B products that intersect with our
area of interest. We will search for products that were collected
between January 1st and January 31st, 2023.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1b_search</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chewie-find-gedi.html">find_gedi</a></span><span class="op">(</span><span class="va">pcreek</span>,</span>
<span>  gedi_product <span class="op">=</span> <span class="st">"1B"</span>,</span>
<span>  date_start <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span>
<span>  date_end <span class="op">=</span> <span class="st">"2023-01-31"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Using cached GEDI find result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g1b_search</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">chewie.find</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #00BB00; font-weight: bold;">GEDI-1B</span></span></span>
<span><span class="co">#&gt;                     id          time_start            time_end                                                   url cached</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;              &lt;POSc&gt;              &lt;POSc&gt;                                                &lt;char&gt; &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1: G2755093540-LPCLOUD 2023-01-25 05:14:31 2023-01-25 06:47:21 https://data.lpdaac.earthdatacloud.nasa.gov/lp-pro...   TRUE</span></span>
<span><span class="co">#&gt; 1 variable(s) not shown: [geometry &lt;sfc_POLYGON&gt;]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
<p>You’ll see that only one granule was found. The returned
<code>gedi.find</code> object contains information about the search,
including whether or not the files are cached locally.</p>
<p>Now we can download the GEDI Level 1B products. However, note that
the <code><a href="../reference/grab_gedi.html">grab_gedi()</a></code> function will not download the products if
they are already cached locally. It first checks the cache and grabs the
relevant files if they exist. If they do not exist, they’ll be
downloaded from the LPCLOUD bucket. {chewie} will, by default only
download specific data columns. There are many variables contained in
the raw hdf5 files.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gedi_1b_arrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_gedi.html">grab_gedi</a></span><span class="op">(</span><span class="va">g1b_search</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> All data found in cache</span></span>
<span><span class="co">#&gt; Warning: Potentially unsafe or invalid elements have been discarded from R metadata.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Type: "externalptr"</span></span>
<span><span class="co">#&gt; → If you trust the source, you can set `options(arrow.unsafe_metadata = TRUE)` to preserve them.</span></span>
<span><span class="co">#&gt; Potentially unsafe or invalid elements have been discarded from R metadata.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Type: "externalptr"</span></span>
<span><span class="co">#&gt; → If you trust the source, you can set `options(arrow.unsafe_metadata = TRUE)` to preserve them.</span></span></code></pre></div>
<p>The <code><a href="../reference/grab_gedi.html">grab_gedi()</a></code> function returns a
<em>arrow_dplyr_query</em> object. If the user wishes to carry out
further filtering (for example using quality flags), this should be done
at this stage to avoid loading unnecessary data into memory.</p>
<p>In order to access the data we must first collect the data into a
data frame. This could be done using <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect</a></code>.
However, the <code><a href="../reference/collect_gedi.html">collect_gedi()</a></code> function is a wrapper around
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect</a></code> that also converts the data to an
<code>sf</code> object, immediately providing a spatial context for the
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1b_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_gedi.html">collect_gedi</a></span><span class="op">(</span><span class="va">gedi_1b_arrow</span>, <span class="va">g1b_search</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Potentially unsafe or invalid elements have been discarded from R metadata.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Type: "externalptr"</span></span>
<span><span class="co">#&gt; → If you trust the source, you can set `options(arrow.unsafe_metadata = TRUE)` to preserve them.</span></span>
<span><span class="co">#&gt; Potentially unsafe or invalid elements have been discarded from R metadata.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Type: "externalptr"</span></span>
<span><span class="co">#&gt; → If you trust the source, you can set `options(arrow.unsafe_metadata = TRUE)` to preserve them.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g1b_sf</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 349 features and 82 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -124.0638 ymin: 41.39252 xmax: -123.9959 ymax: 41.43934</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 349 × 83</span></span></span>
<span><span class="co">#&gt;    all_samples_sum  beam channel delta_time date_time           master_frac</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>        15<span style="text-decoration: underline;">977</span>748     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.083<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>        15<span style="text-decoration: underline;">982</span>175     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.091<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>        15<span style="text-decoration: underline;">974</span>693     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.099<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>        15<span style="text-decoration: underline;">983</span>026     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.108 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>        15<span style="text-decoration: underline;">991</span>944     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.116 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        15<span style="text-decoration: underline;">978</span>705     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.125 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        15<span style="text-decoration: underline;">973</span>741     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.133 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        15<span style="text-decoration: underline;">981</span>653     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.141 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        15<span style="text-decoration: underline;">991</span>093     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.149 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        15<span style="text-decoration: underline;">999</span>630     0       0 159<span style="text-decoration: underline;">862</span>145. 2023-01-25 <span style="color: #949494;">06:09:05</span>      0.158 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 339 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 77 more variables: master_int &lt;int&gt;, noise_mean_corrected &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   noise_stddev_corrected &lt;dbl&gt;, nsemean_even &lt;dbl&gt;, nsemean_odd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   rx_energy &lt;dbl&gt;, rx_offset &lt;int&gt;, rx_open &lt;int&gt;, rx_sample_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   rx_sample_start_index &lt;int&gt;, selection_stretchers_x &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   selection_stretchers_y &lt;int&gt;, shot_number &lt;chr&gt;, stale_return_flag &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   th_left_used &lt;int&gt;, tx_egamplitude &lt;dbl&gt;, tx_egamplitude_error &lt;dbl&gt;, …</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g1b_sf</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">g1b_search</span><span class="op">)</span><span class="op">$</span><span class="va">aoi</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"#7700ff"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gedi-L1B-waveforms_files/figure-html/plot-gedi-1.png" width="700"></p>
<p>So, here’s the cool bit about the way the Level-1B data are
extracted. We can access the full waveform for every shot in the data
set by using the <code><a href="../reference/extract_waveforms.html">extract_waveforms()</a></code> function. This
generates a long-form data frame with waveform amplitude, relative
elevation, and shot number for each shot. This enables the combined
analysis and comparison of many waveforms across space (and time when we
have multiple granules).</p>
<p>For example, here we take 8 of the waveforms…</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1b_wvf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_waveforms.html">extract_waveforms</a></span><span class="op">(</span><span class="va">g1b_sf</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">108</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g1b_wvf</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9,881 × 4</span></span></span>
<span><span class="co">#&gt;    shot_number        date_time           rxelevation rxwaveform</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        457.       247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        457.       247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        457.       245.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        457.       243.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       242.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       241.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       242.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       243.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       245.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 233300000300278259 2023-01-25 <span style="color: #949494;">06:09:05</span>        456.       246.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9,871 more rows</span></span></span></code></pre></div>
<p>And plot them using <code>ggplot2</code>…</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wvf_ggplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">wf</span>, <span class="va">z</span>, <span class="va">.ylab</span> <span class="op">=</span> <span class="st">"Elevation (m)"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">wf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">wf</span><span class="op">)</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">z</span>, y <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">wf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">wf</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">wf</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.6</span>, fill <span class="op">=</span> <span class="st">"#69d66975"</span>, colour <span class="op">=</span> <span class="st">"grey30"</span>, lwd <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.ylab</span>, y <span class="op">=</span> <span class="st">"Waveform Amplitude"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">wvf_ggplot</span><span class="op">(</span><span class="va">g1b_wvf</span>, <span class="st">"rxwaveform"</span>, <span class="st">"rxelevation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">shot_number</span>, ncol <span class="op">=</span> <span class="fl">5</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gedi-L1B-waveforms_files/figure-html/plot-waveforms-1.png" width="700"></p>
<p>We can also calculate the mean waveform for these shots and plot it.
<em>Note that this may not be particualtly helpful for all contexts, but
it provides an indication of the power of having access to all waveforms
in a single dataset.</em></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1b_wvf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">shot_number</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">rxelevation</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_wvf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rxwaveform</span><span class="op">)</span>,</span>
<span>    mean_elev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rxelevation</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">wvf_ggplot</span><span class="op">(</span><span class="st">"mean_wvf"</span>, <span class="st">"id"</span>, .ylab <span class="op">=</span> <span class="st">"Sequence order"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="gedi-L1B-waveforms_files/figure-html/plot-mean-waveforms-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">".Renviron"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">".Renviron"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hugh Graham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
